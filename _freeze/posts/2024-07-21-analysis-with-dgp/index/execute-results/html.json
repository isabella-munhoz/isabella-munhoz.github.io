{
  "hash": "18a54955229affb90c29b2a31022f894",
  "result": {
    "markdown": "---\ntitle: \"Quando os confundidores nos confundem\"\ndescription: \"Usando DGP para enxergar problemas na análise descritiva\"\nauthor:\n  - name: Isabella Munhoz\n    #url: www.isabelamunhoz.com\ndate: 2024-07-21\n#categories: [categoria-teste] # self-defined categories\n#image: cookie-image.jpeg\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\n---\n\n::: {.cell}\n\n:::\n\n\n# Motivação\n\nAcredito que, atualmente, o livro \"The Effect\" do professor Nick Huntington-Klein tem sido meu maior companheiro de estudo. \n\nCaminho em ciência de dados me levou a estudar inúmeras coisas, mas com certeza causalidade tem ganhado um espaço grande no meu coração.\n\nNick Huntington-Klein tem a qualidade que mais admiro em um professor: traduzir temas complexos de forma simples através de exemplos palpáveis, que nos permitem trazer o conteúdo teórico para a realidade.\n\nUm ponto chave na carreira do cientista de dados também é conseguir traduzir o que fazemos para áreas não técnicas (as áreas para as quais vamos, em geral, entregar nossos modelos e conclusões).\n\nDurante a leitura do capítulo X, um exemplo que ele deu me chamou a atenção... Ness parte do livro, Nick (já sinto que ele um amigo próximo) trouxe um exemplo que me acendeu uma luz de como traduzir para áreas não técnicas como análises descritivas, que não levam em conta variáveis confundidoras, podem nos levar a conclusões equivocadas. Pra isso, ele usou o processo gerador de dados para simular uma população e mostrar como podemos concluir algo errado quando não desenhamos os caminhos alternativos que explicam causalidade.\n\nVou tentar usar o exemplo dele (e algumas outras coisas que refleti enquanto lia esse capítulo) para mostrar como as vriáveis confundidoras podem nos colcar em apuros.\n  \n# Criando o nosso universo\n\nVamos começar simulando uma população. Dado que estamos criando todas as regras de como nosso universo funciona, sabemos exatamente o processo gerador dos dados (DGP) e podemos concluir como as coisas acontecem...\n\nNo nosso mudinho, temos as seguinte regras:\n\n- 30% dos indivíduos possuem diploma\n- 20% dos indivíduos possuem cabelo castanho\n- O salário dos indivíduos segue uma distrbuição log-normal\n- Se um indivíduo tem diploma, seu salário aumenta em 20%\n- Se um indivíduo tem cabelo castanho, seu salário aumenta em 10%\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# definindo o tamanho da população\npop_size <- 1000000\n\nset.seed(123)\npopulation <- tibble(\n  # gerando o id do indivíduo\n  id = 1:pop_size,\n  # gerando uma distribuição binomial, com 30% de probabilidade do usuário em ter um diploma\n  college_degree = rbinom(pop_size, size = 1, prob = 0.3),\n  # gerando uma distribuição binomial, com 20% de probabilidade do usuário em ter um cabelo castanho\n  brown_hair = rbinom(pop_size, size = 1, prob = 0.2)\n)\n\n# sumarizando os dados da população\npopulation |> \n  summarise(\n    perc_college_degree = (sum(college_degree) / n()) * 100,\n    perc_brown_hair = (sum(brown_hair) / n()) * 100\n  ) |> \n  kable(caption = \"Tabela\", format = \"html\") |> \n  kable_styling(\n    bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"),\n    full_width = FALSE,\n    position = \"center\"\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Tabela</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> perc_college_degree </th>\n   <th style=\"text-align:right;\"> perc_brown_hair </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 29.9644 </td>\n   <td style=\"text-align:right;\"> 20.0046 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nPara cada indivíduo gerado na nossa população, vamos calcular o salário conforme as regras estabelecidas acima.\n\n**Um pequeno parênteses sobre o cálculo do salário...**\n\nConforme dito, o salário é log-normal. A primeira vez que pensei em como simular, foi ...  Contudo, olhando no livro, o autor indicava calulcar o salário da seguinte maneira... Só queria mostrar aqui que ambos os jeitos equivalem a mesma coisa...\n\nVamos seguir no cógido calculando o salário conforme o Nick indicou...\n\n\n::: {.cell}\n\n:::\n\n\nPlot do salário\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nPlot do log do salário\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nComo sabemos que indivíduos de cabelo castanho tem um salário 10% maior, esperamos ver isso nos dados...\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Tabela</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> brown_hair </th>\n   <th style=\"text-align:right;\"> mean_log_income </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 5.059141 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5.155302 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nSe segmentamos essa análise somente para indivíduos que não possuem diploma, chegamos na mesma conclusão.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Tabela</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> brown_hair </th>\n   <th style=\"text-align:right;\"> mean_log_income </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 4.999011 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5.092591 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Tabela</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> brown_hair </th>\n   <th style=\"text-align:right;\"> mean_log_income </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 5.199745 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5.301623 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nSo far so good... Dentro dos segmentos, conseguimos notar que o salário tem a diferença esperada. Um outro jeito que podemos ver isso é olhando para a porcentagem de indivíduos de cabelo castanho na população e nas segmentação college == 0 e college == 1. Em todos esses grupos, a quantidade de usuário se mantém igual ao DPG (de ~20%).\n\nUma outra conclusão que podemo tirar é que as variáveis college_degree e bronw_hair são independentes, porque uma variáve não afeta a distribuição da outra variável na população.\n\n\n# Criando um outro universo...\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `sum(hair)/n()`\n            <dbl>\n1           0.436\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `sum(hair)/n()`\n            <dbl>\n1           0.516\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `sum(hair)/n()`\n            <dbl>\n1           0.243\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 292\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 206\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 3\n      n     s  perc\n  <int> <dbl> <dbl>\n1   573   230  40.1\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 436\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}